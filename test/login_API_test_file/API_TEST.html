<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>API LOGIN TEST</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

    <script type="text/javascript">

            <!--    회원 가입 함수      -->
            function sign_up() {

                let ID = $('#ID').val()
                let PASSWORD = $('#PASSWORD').val()
                let NAME = $('#NAME').val()
                let SEX = $('#SEX option:selected').val()
                let PHONE_NUMBER = $('#phone1').val() + $('#phone2').val() + $('#phone3').val()
                let RRN = $('#RRN_1').val() + $('#RRN_2').val()
                let E_MAIL = $('#E_MAIL').val()
                let LOCATION = $('#LOCATION').val()
                // let BOOKMARK = $('#BOOKMARK').val()

                $.ajax({
                    type: "POST",
                    url: "/login",
                    data: {ID_give:ID, PASSWORD_give:PASSWORD, NAME_give:NAME, SEX_give:SEX, PHONE_NUMBER_give:PHONE_NUMBER,RRN_give:RRN, E_MAIL_give:E_MAIL, LOCATION_give:LOCATION},
                    success: function (response) {
                        alert(response["msg"]);
                        window.location.reload();
                    }
                })
            }
            // 로그인 함수
            function sign_in() {

                $.ajax({
                    type: "GET",
                    url: "/login",
                    data: {},
                    success: function (response) {
                        let member_list = response['all_member_list']
                        for (let i = 0; i < member_list.length; i++) {
                            let ID = member_list[i]['ID']
                            let PASSWORD = member_list[i]['PASSWORD']
                            let NAME = member_list[i]['NAME']
                            let SEX = member_list[i]['SEX']
                            let PHONE_NUMBER = member_list[i]['PHONE_NUMBER']
                            let E_MAIL = member_list[i]['E_MAIL']
                            let LOCATION = member_list[i]['LOCATION']
                            let BOOKMARK = member_list[i]['BOOKMARK']
                        }
                    }
                })
            }

        </script>


        <script>

        function changePhone1(){
            const phone1 = document.getElementById("phone1").value // 010
            if(phone1.length === 3){
            document.getElementById("phone2").focus();
            }
        }
        function changePhone2(){
            const phone2 = document.getElementById("phone2").value // 010
            if(phone2.length === 4){
            document.getElementById("phone3").focus();
            }
        }
        function changePhone3(){
            const phone3 = document.getElementById("phone3").value // 010
        }



        let processID = -1;





    // 가입부분 체크

        function signUpCheck(){

          let email = document.getElementById("E_MAIL").value
          let name = document.getElementById("NAME").value
          let password = document.getElementById("PASSWORD").value
          let passwordCheck = document.getElementById("passwordCheck").value
          let area = document.getElementById("LOCATION").value
          let gender = document.getElementById("gender").options.selectedIndex
          let check = true;

          // 이메일확인
          if(email.includes('@')){
            let emailId = email.split('@')[0]
            let emailServer = email.split('@')[1]
            if(emailId === "" || emailServer === ""){
              document.getElementById("emailError").innerHTML="이메일이 올바르지 않습니다."
              check = false
            }
            else{
              document.getElementById("emailError").innerHTML=""
            }
          }else{
            document.getElementById("emailError").innerHTML="이메일이 올바르지 않습니다."
            check = false
          }


          // 이름확인
          if(name===""){
            document.getElementById("nameError").innerHTML="이름이 올바르지 않습니다."
            check = false
          }else{
            document.getElementById("nameError").innerHTML=""
          }


          // 비밀번호 확인
          if(password !== passwordCheck){
            document.getElementById("passwordError").innerHTML=""
            document.getElementById("passwordCheckError").innerHTML="비밀번호가 동일하지 않습니다."
            check = false
          }else{
            document.getElementById("passwordError").innerHTML=""
            document.getElementById("passwordCheckError").innerHTML=""
          }

          if(password===""){
            document.getElementById("passwordError").innerHTML="비밀번호를 입력해주세요."
            check = false
          }else{
            //document.getElementById("passwordError").innerHTML=""
          }
          if(passwordCheck===""){
            document.getElementById("passwordCheckError").innerHTML="비밀번호를 다시 입력해주세요."
            check = false
          }else{
            //document.getElementById("passwordCheckError").innerHTML=""
          }


          // 지역선택 확인
          if(area === "지역을 선택하세요."){
            document.getElementById("areaError").innerHTML="지역을 선택해주세요."
            check = false
          }else{
            document.getElementById("areaError").innerHTML=""
          }

          // 성별체크확인


          if(check){
            document.getElementById("emailError").innerHTML=""
            document.getElementById("nameError").innerHTML=""
            document.getElementById("passwordError").innerHTML=""
            document.getElementById("passwordCheckError").innerHTML=""
            document.getElementById("areaError").innerHTML=""
            document.getElementById("genderError").innerHTML=""

            //비동기 처리이벤트
            setTimeout(function() {
              alert("가입이 완료되었습니다.")
          },0);
          }
        }

    </script>



</head>
<body>
    <div class="wrapper">
            <div class="title"><h1 style="font-size: 21px;">회원가입</h1></div>
            <div class="email">
                <input id="E_MAIL" type="text" placeholder="이메일을 입력해 주세요.">
                <div id="emailError" class="error"></div>
            </div>
            <div class="id">
                <input id="ID" type="text" placeholder="아이디를 입력해 주세요.">

            </div>
            <div class="name">
                <input id="NAME"  type="text" placeholder="이름을 입력해 주세요.">
                <div id="nameError" class="error"></div>
            </div>
            <div class="password">
                <input id="PASSWORD" type="password" placeholder="비밀번호를 입력해 주세요.">
                <div id="passwordError" class="error"></div>
            </div>
            <div class="passwordCheck">
                <input id="passwordCheck" type="password" placeholder="비밀번호를 다시 입력해 주세요.">
                <div id="passwordCheckError" class="error"></div>
            </div>
            <div class="phone">
                <input id="phone1" type="text" size="1" maxlength="3" oninput="changePhone1()"> -
                <input id="phone2" type="text" size="3" maxlength="4" oninput="changePhone2()"> -
                <input id="phone3" type="text" size="3" maxlength="4" oninput="changePhone3()">
            </div>
            <div class="RRN">
                <input id="RRN_1" type="text" size="5" maxlength="6"> -
                <input id="RRN_2" type="text" size="6" maxlength="7">
            </div>

            <div class="area">
                <select id="LOCATION">
                    <option selected disabled>지역을 선택하세요.</option>
                    <option>서울</option>
                    <option>인천</option>
                    <option>경기</option>
                </select>
                <div id="areaError" class="error"></div>
            </div>

            <div class="gender">
                <select class="form-select" id ="SEX" aria-label="Default select example">
                  <option selected>성별</option>
                  <option value="male">남자</option>
                  <option value="female">여자</option>
                </select>
            </div>

            <div class="line">
                <hr>
            </div>

            <div class="signUp">
                <button id="signUpButton" onclick="sign_up()">가입하기</button>
            </div>
        </div>

</body>
</html>
